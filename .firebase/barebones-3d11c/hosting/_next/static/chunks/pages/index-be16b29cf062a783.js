(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(4985)}])},4985:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return j}});var a=t(5893),r=t(7294),n=t(3977),l=t(9828),o=t(1259),c=t(7004);let d=(0,n.ZF)({apiKey:"AIzaSyBbdNzJHy4WufxD4QLCDRVljc9tdL0ZVHA",authDomain:"barebones-3d11c.firebaseapp.com",projectId:"barebones-3d11c",storageBucket:"barebones-3d11c.appspot.com",messagingSenderId:"1093321436265",appId:"1:1093321436265:web:32ccb88760b8fbe54f86f8",measurementId:"G-T7R7V05DTS"}),i=(0,l.ad)(d),m=(0,o.v0)(d);(0,c.$C)(d);let u=()=>{let[e,s]=(0,r.useState)(""),[t,n]=(0,r.useState)(""),[l,c]=(0,r.useState)(""),[d,i]=(0,r.useState)(!1),u=s=>{s.preventDefault(),c(""),i(!0),(0,o.Xb)(m,e,t).then(e=>{console.log("registered",e),i(!1)}).catch(e=>{c(e.message),i(!1)})};return(0,a.jsxs)("div",{className:"my-4",children:[(0,a.jsx)("h3",{children:"Create Account"}),(0,a.jsxs)("form",{onSubmit:u,className:"flex gap-2 mt-2",children:[(0,a.jsx)("input",{type:"email",placeholder:"Enter your email",value:e,onChange:e=>s(e.target.value)}),(0,a.jsx)("input",{type:"password",placeholder:"Enter your password",value:t,onChange:e=>n(e.target.value)}),(0,a.jsx)("button",{type:"submit",children:"Sign Up"})]}),d&&(0,a.jsx)("p",{children:"Loading..."}),l&&(0,a.jsx)("p",{className:"error",children:l})]})},h=()=>{let[e,s]=(0,r.useState)(""),[t,n]=(0,r.useState)(""),[l,c]=(0,r.useState)(""),[d,i]=(0,r.useState)(!1),u=s=>{s.preventDefault(),c(""),i(!0),(0,o.e5)(m,e,t).then(e=>{console.log("logged in",e),i(!1)}).catch(e=>{c(e.message),i(!1)})};return(0,a.jsxs)("div",{className:"my-4",children:[(0,a.jsx)("h3",{children:"Sign In"}),(0,a.jsxs)("form",{onSubmit:u,className:"flex gap-2 mt-2",children:[(0,a.jsx)("input",{type:"email",placeholder:"Enter your email",value:e,onChange:e=>s(e.target.value)}),(0,a.jsx)("input",{type:"password",placeholder:"Enter your password",value:t,onChange:e=>n(e.target.value)}),(0,a.jsx)("button",{type:"submit",children:"Log In"})]}),d&&(0,a.jsx)("p",{children:"Loading..."}),l&&(0,a.jsx)("p",{className:"error",children:l})]})};var x=t(595),p=t(9252),g=t(1795);function j(){let[e,s]=(0,r.useState)(null),[t,n]=(0,r.useState)(""),[c,d]=(0,r.useState)(""),[p,g]=(0,r.useState)(),[j,f]=(0,r.useState)(""),[b,v]=(0,r.useState)(),[N,S]=(0,r.useState)();(0,r.useEffect)(()=>{let e=(0,o.Aj)(m,e=>{e?s(e):s(null)});return()=>e()},[]),(0,r.useEffect)(()=>{if(e){let s=(0,l.IO)((0,l.hJ)(i,"rooms"),(0,l.ar)("members","array-contains",e.uid)),t=(0,l.cf)(s,e=>{let s=[];e.docs.forEach(e=>{s.push({...e.data(),id:e.id})}),g(s)});return()=>t()}},[e]),(0,r.useEffect)(()=>{if(void 0!==b){let e=(0,l.IO)((0,l.hJ)(i,"rooms",b,"messages"),(0,l.Xo)("createdAt","desc"));try{let s=(0,l.cf)(e,e=>{let s=[];e.docs.forEach(e=>{s.push({...e.data(),id:e.id})}),S(s)});return()=>s()}catch(t){console.error("Error adding document: ",t)}}},[b]);let y=()=>{(0,o.w7)(m).then(()=>{console.log("sign out successful")}).catch(e=>console.log(e))},E=s=>{s.preventDefault();let t=(0,l.hJ)(i,"rooms");if(j.length>4)try{(0,l.ET)(t,{name:j,roomOwner:e.uid,createdAt:(0,l.Bt)(),members:[e.uid]}),f("")}catch(a){console.error("Error adding document: ",a)}console.log("New Room Added",j)},w=e=>{e.preventDefault();let s=(0,l.JU)(i,"rooms",b);try{(0,l.r7)(s,{members:(0,l.vr)(c)}),console.log("added",c),d("")}catch(t){console.error("Error adding document: ",t)}},C=s=>{s.preventDefault();let a=(0,l.hJ)(i,"rooms",b,"messages");try{(0,l.ET)(a,{message:t,sentBy:e.email,sentById:e.uid,createdAt:(0,l.Bt)()}),n("")}catch(r){console.error("Error adding document: ",r)}};return(0,a.jsx)("div",{className:"m-8",children:e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-between w-full mb-8",children:[(0,a.jsx)("p",{children:"Signed In ".concat(e.email,", ").concat(e.uid)}),(0,a.jsx)("button",{type:"text",onClick:y,children:"Sign Out"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-12",children:[(0,a.jsxs)("div",{className:"grid col-span-4 gap-6 p-8 rounded bg-slate-200",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"mb-2",children:"Select Room"}),(0,a.jsxs)("select",{id:"rooms",name:"rooms",value:b,onChange:e=>v(e.target.value),children:[(0,a.jsx)("option",{disabled:!0,children:"Select a room"}),p&&p.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"mb-2",children:"Create New Room"}),(0,a.jsxs)("form",{onSubmit:E,className:"flex gap-2",children:[(0,a.jsx)("input",{onChange:e=>f(e.target.value),value:j,placeholder:"New room name...",name:"room",id:"room"}),(0,a.jsx)("button",{className:"p-4 text-sm rounded w-36 text-slate-100 bg-slate-800",children:"Create Room"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"mb-2",children:["Room Members ",b||"SELECT ROOM FIRST"]}),(0,a.jsxs)("form",{onSubmit:w,className:"flex gap-2",children:[(0,a.jsx)("input",{onChange:e=>d(e.target.value),value:c,placeholder:"Paste in user id",name:"memberId",id:"memberId"}),(0,a.jsx)("button",{className:"p-4 text-sm rounded w-36 text-slate-100 bg-slate-800",children:"Add Member"})]})]})]}),(0,a.jsx)("div",{className:"col-span-8 mx-8",children:b?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("form",{onSubmit:C,className:"flex",children:[(0,a.jsx)("input",{onChange:e=>n(e.target.value),value:t,name:"comment",id:"comment"}),(0,a.jsx)("button",{className:"p-4 ml-2 text-sm border rounded text-slate-100 bg-slate-800",children:"Send"})]}),(0,a.jsx)("div",{className:"",children:N&&N.map(s=>(0,a.jsxs)("div",{className:s.sentById===e.uid?"justify-self-end my-4 text-end":"justify-self-start my-4",children:[(0,a.jsx)("p",{className:"text-xs text-gray-400",children:s.sentBy}),(0,a.jsx)("p",{className:"mb-1",children:s.message}),s.createdAt&&(0,a.jsxs)("p",{className:"text-xs text-gray-400",children:["(",(0,a.jsx)(x.Z,{date:s.createdAt.toDate(),locale:"en-US"}),")"]})]},s.id))})]}):(0,a.jsx)("p",{className:"mt-0 error",children:"No Room Selected: Create or request to join a room"})})]})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"my-4",children:"Firebase Barebones"}),(0,a.jsx)(u,{}),(0,a.jsx)(h,{})]})})}p.Z.addDefaultLocale(g.Z)}},function(e){e.O(0,[16,597,677,774,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);